;------------------------------------------------------------
function get_swap_resp,vc,theta,phi,w,s4,eff
;------------------------------------------------------------
  aeff=0.033
  aeff=aeff/0.0882d
  dect_eff=eff
  aeff=dect_eff*aeff
  mp=1.67262158D-27
  kb=1.380658D-23
  e=1.6E-19 
  ee=.5*mp/e*(vc*1000.)^2 

  wp=interpol(w.w, w.phi,phi)
  junk=min(abs(ee-s4.ecen),iee)

  junk=min(abs(theta-(-s4.x)),ix)

  er1=s4.y(iee,*)*ee

  tt=s4.arr(*,ix,iee)
  szv=5.0
  ipos=where(tt gt 0)
  enew=min(er1(ipos)) + findgen(szv)*(max(er1(ipos))-min(er1(ipos)))/(szv-1.)
 

  ttnew=interpol(tt,er1, enew)

  res = wp*ttnew*aeff

return,res
end
;------------------------------------------------------------
